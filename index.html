<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Зеленое пламя - не дай всем деревьям сгореть!</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #e0f7fa;
            color: #333;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .header {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px;
            background-color: #004d40;
            color: white;
        }
        .header div {
            display: flex;
            align-items: center;
        }
        .header span {
            margin-left: 5px;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            gap: 2px;
            padding: 10px;
            background-color: #a7ffeb;
            margin: 0 auto;
            max-width: 1440px;
            height: 810px;
            overflow: auto;
        }
        .tree-container {
            position: relative;
            width: 50px;
            height: 50px;
        }
        .tree-container img {
            width: 100%;
            height: 100%;
            display: block;
        }
        .tree-container .fire {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
        }
        .tools, .shop, .sidebar, .news-bar, .message {
            position: absolute;
            padding: 10px;
            background-color: white;
            border: 2px solid #004d40;
            border-radius: 10px;
        }
        .tools {
            top: 10px;
            left: 10px;
            width: 200px;
        }
        .tools .tool {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .tools .tool img {
            width: 40px;
            height: 40px;
        }
        .tools .tool .count {
            margin-left: 10px;
        }
        .shop {
            top: 10px;
            right: 10px;
            width: 50px;
            cursor: pointer;
        }
        .shop .tooltip {
            display: none;
            position: absolute;
            top: 50px;
            right: 0;
            background-color: #004d40;
            color: white;
            padding: 5px;
            border-radius: 5px;
            white-space: nowrap;
        }
        .shop:hover .tooltip {
            display: block;
        }
        .sidebar {
            top: 70px;
            right: -300px;
            width: 300px;
            transition: right 0.3s;
        }
        .sidebar.open {
            right: 10px;
        }
        .sidebar h2 {
            margin-top: 0;
        }
        .sidebar .sidebar-item {
            margin-bottom: 10px;
            cursor: pointer;
        }
        .news-bar {
            top: 70px;
            left: 10px;
            width: 300px;
            height: 200px;
            overflow: hidden;
        }
        .news-bar h2 {
            margin-top: 0;
        }
        .news-bar .news-item {
            display: none;
        }
        .news-bar .news-item.active {
            display: block;
        }
        .message {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 5px 20px;
            background-color: #004d40;
            color: white;
            border-radius: 10px;
        }
        .alert {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: red;
            color: white;
            padding: 10px;
            border-radius: 10px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="budget">
            Бюджет: <span id="budget">100000</span>
            <div id="budgetTooltip">Заработано: 0, Потрачено: 0</div>
        </div>
        <div class="level-time">
            Время: <span id="levelTime">1:00</span>
        </div>
        <div class="fire-class">
            Класс пожарной опасности: <span id="fireClass">1</span>
        </div>
    </div>
    <div class="tools">
        <div class="tool" id="helicopter">
            <img src="assets/helicopter.png" alt="Helicopter">
            <div class="count" id="helicopterCount">3</div>
            <div class="tooltip">Вертолет: Используется для тушения пожара с воздуха.</div>
        </div>
        <div class="tool" id="firefighter">
            <img src="assets/firefighter.png" alt="Firefighter">
            <div class="count" id="firefighterCount">20</div>
            <div class="tooltip">Пожарный: Используется для тушения пожара вручную.</div>
        </div>
    </div>
    <div class="shop">
        <img src="assets/shop.png" alt="Shop" id="shopToggle">
        <div class="tooltip">Магазин</div>
    </div>
    <div class="game-board" id="gameBoard">
        <!-- Деревья и огонь -->
    </div>
    <div class="message" id="message"></div>
    <div class="sidebar" id="sidebar">
        <h2>Магазин</h2>
        <div class="sidebar-item" data-item="seeds">Семена (10000) - Восстанавливают сгоревшие деревья.</div>
        <div class="sidebar-item" data-item="helicopterOrder">Вертолет (15000) - Заказывает дополнительный вертолет.</div>
        <div class="sidebar-item" data-item="firefighter">Пожарный (500) - Нанимает дополнительного пожарного.</div>
    </div>
    <div class="news-bar">
        <h2>Новости леса</h2>
        <div class="news-item" id="newsItem1">Лесные жители обеспокоены возможностью пожаров.</div>
        <div class="news-item" id="newsItem2">В лесу повысился уровень пожарной опасности.</div>
        <div class="news-item" id="newsItem3">Пожарные бригады готовы к действиям.</div>
    </div>
    <script>
        const gameBoard = document.getElementById('gameBoard');
        const budgetElement = document.getElementById('budget');
        const levelTimeElement = document.getElementById('levelTime');
        const fireClassElement = document.getElementById('fireClass');
        const shopToggle = document.getElementById('shopToggle');
        const shopItems = document.getElementById('shopItems');
        const sidebar = document.getElementById('sidebar');
        const message = document.getElementById('message');
        const budgetTooltip = document.getElementById('budgetTooltip');
        const newsBar = document.querySelector('.news-bar');
        const newsItems = document.querySelectorAll('.news-item');

        let budget = 100000;
        let levelTime = 60;
        let fireClass = 1;
        let firesExtinguished = 0;
        let selectedTool = null;
        let newsIndex = 0;
        let level = 1;
        let timer = null;

        const tools = {
            helicopter: {
                element: document.getElementById('helicopter'),
                countElement: document.getElementById('helicopterCount'),
                uses: 3,
                cooldown: 20000,
                message: 'Выбран вертолет',
            },
            firefighter: {
                element: document.getElementById('firefighter'),
                countElement: document.getElementById('firefighterCount'),
                uses: 20,
                cooldown: 10000,
                message: 'Выбран пожарный',
            }
        };

        const trees = [];

        function init() {
            // Create trees and fires
            for (let i = 0; i < 150; i++) {
                const treeContainer = document.createElement('div');
                treeContainer.classList.add('tree-container');

                const fire = document.createElement('img');
                fire.src = 'assets/fire.png';
                fire.classList.add('fire');
                fire.style.display = 'none';
                treeContainer.appendChild(fire);

                const tree = document.createElement('img');
                tree.src = 'assets/tree.png';
                treeContainer.appendChild(tree);

                gameBoard.appendChild(treeContainer);

                trees.push({ treeContainer, fire, tree, burning: false });
            }

            updateBudget();
            startTimer();
            updateNews();
        }

        function updateBudget() {
            budgetElement.textContent = budget;
        }

        function startTimer() {
            timer = setInterval(() => {
                if (levelTime > 0) {
                    levelTime--;
                    levelTimeElement.textContent = formatTime(levelTime);
                } else {
                    clearInterval(timer);
                    message.textContent = `Уровень ${level} завершен!`;
                    level++;
                    levelTime = 60 + (level - 1) * 30;
                    fireClass = level;
                    fireClassElement.textContent = fireClass;
                    setTimeout(startTimer, 3000);
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function updateNews() {
            newsItems.forEach((item, index) => {
                item.classList.toggle('active', index === newsIndex);
            });
            newsIndex = (newsIndex + 1) % newsItems.length;
            setTimeout(updateNews, 10000);
        }

        function purchaseItem(item) {
            switch (item) {
                case 'seeds':
                    if (budget >= 10000) {
                        budget -= 10000;
                        message.textContent = 'Куплены семена';
                        // Логика восстановления деревьев
                    } else {
                        message.textContent = 'Недостаточно средств';
                    }
                    break;
                case 'helicopterOrder':
                    if (budget >= 15000) {
                        budget -= 15000;
                        tools.helicopter.uses++;
                        message.textContent = 'Заказан вертолет';
                    } else {
                        message.textContent = 'Недостаточно средств';
                    }
                    break;
                case 'firefighter':
                    if (budget >= 500) {
                        budget -= 500;
                        tools.firefighter.uses++;
                        message.textContent = 'Нанят пожарный';
                    } else {
                        message.textContent = 'Недостаточно средств';
                    }
                    break;
            }
            updateBudget();
            updateBudgetTooltip();
        }

        function updateBudgetTooltip() {
            budgetTooltip.textContent = `Заработано: ${firesExtinguished * 5000}, Потрачено: ${100000 - budget}`;
        }

        function extinguishFire(tree) {
            if (selectedTool === tools.helicopter && tools.helicopter.uses > 0) {
                tree.burning = false;
                tree.fire.style.display = 'none';
                tree.tree.src = 'assets/tree.png';
                firesExtinguished++;
                budget += 5000;
                tools.helicopter.uses--;
                tools.helicopter.countElement.textContent = tools.helicopter.uses;
            } else if (selectedTool === tools.firefighter && tools.firefighter.uses > 0) {
                tree.burning = false;
                tree.fire.style.display = 'none';
                tree.tree.src = 'assets/tree.png';
                firesExtinguished++;
                budget += 5000;
                tools.firefighter.uses--;
                tools.firefighter.countElement.textContent = tools.firefighter.uses;
            }
            updateBudget();
            updateBudgetTooltip();
        }

        trees.forEach(tree => {
            tree.treeContainer.addEventListener('click', () => {
                if (tree.burning) {
                    extinguishFire(tree);
                }
            });
        });

        Object.values(tools).forEach(tool => {
            tool.element.addEventListener('click', () => {
                selectedTool = tool;
                message.textContent = tool.message;
            });
        });

        shopToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        sidebar.addEventListener('click', (e) => {
            if (e.target.dataset.item) {
                purchaseItem(e.target.dataset.item);
            }
        });

        init();
    </script>
</body>
</html>
